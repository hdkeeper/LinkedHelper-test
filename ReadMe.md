# Тестовое задание "Планировщик задач"

* Каждая отдельная задача выглядит следующим образом:
  ```
  interface Task {
    targetId: number
    action: 'init' | 'prepare' | 'work' | 'finalize' | 'cleanup'
  }
  ```
* Есть специальный класс `Executor` (`src/Executor.ts`), который умеет исполнять одну задачу:
  ```
  Executor.executeTask(task: Task): Promise<void>
  ```

Надо реализовать асинхронную функцию, которая получает на вход очередь
задач `Task[]` и максимальное кол-во одновременных "потоков" `maxThreads` и возвращает промис, который будет разрезолвлен, когде все задачи
отработают.

```
async function run(queue: Queue, maxThreads = 0): Promise<{...}>
```
При `maxThreads == 0` ограничения на кол-во одновременных "потоков" нету.

Основная сложность заключается в том, что в один момент времени `Executor` не может исполнять несколько разных задач с одним и тем же `Task.targetId`, но при этом он может исполнять много разных задач с разными `Task.targetId` параллельно.

* Например, если мы вызовем  
  ```
  executor.executeTask({ targetId: 0, action: 'init' });
  executor.executeTask({ targetId: 0, action: 'prepare' });
  ```  
  то, второй вызов кинет исключение.

* При этом  
  ```
  await executor.executeTask({ targetId: 0, action: 'init' });
  await executor.executeTask({ targetId: 1, action: 'prepare' });
  ```  
  отработает нормально.

Все задачи для одного и того же `Task.targetId` должны быть исполнены последовательно в том порядке, в котором они находятся в очереди.

## Настройка окружения:

* `Node.js version >= 11`

## Установка и подготовка

`npm install`

## Разработка решения
* Заготовка для функции `run()` лежит в `./src/run.ts`. 
* Обвязочный код (строчки `12-13, 20-24`инициализация `executor` и возрат отчета) менять нельзя
* Никакие другие файлы, кроме `./src/run.ts` менять нельзя. 
* Внутри одного вызова `run()` создавать дополнительные эксземпляры `Executor` нельзя.

## Самостоятельная проверка правильности решения

Для удобства я написал тесты для `run()`, которые проверяют правильность её работы.

`npm run test`

